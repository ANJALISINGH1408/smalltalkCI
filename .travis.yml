language: erlang
sudo: false

env:
  global:
    - DEPLOY_TARGET="https://www.hpi.uni-potsdam.de/hirschfeld/artefacts/smalltalkci/"
  matrix:
    - SMALLTALK="Squeak-Trunk"
    - SMALLTALK="Squeak-5.0"
    - SMALLTALK="Squeak-4.6"
    - SMALLTALK="Squeak-4.5"

addons:
  apt:
    packages:
    # 32-bit VM
    - libc6:i386
    # UUIDPlugin
    - libuuid1:i386

install:
  - wget -q -O smalltalkCI.zip https://github.com/hpi-swa/smalltalkCI/archive/dev.zip
  - unzip -q smalltalkCI.zip

script: ./prepare.sh $SMALLTALK

after_success:
  - curl -s -u "$DEPLOY_CREDENTIALS" -T "builds/$SMALLTALK.tar.gz" "$DEPLOY_TARGET"